---
title: "navaging_demographic_nara"
output: html_document
date: "2024-07-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages
```{r}

library(dplyr)
library(ggplot2)
library(ggpubr)
library(stats)
library(xfun)
library(pwr)
library(tidyverse)
library(readr)
library(psych)

```

# Read Data 
```{r}

# Read Non Nav Data Spreadsheet 

alldata <- read.csv('/Users/emmafunderburg/Desktop/Lab/BORICH LAB/8_navaging/NavAging_Paper/stat_tests/non_nav_data_final.csv')
  
# Add Demographic Factors to Data Frame from Abbreviated Questionnaire Answers

demographic_data <- read.csv('/Users/emmafunderburg/Desktop/Lab/BORICH LAB/8_navaging/NavAging_Paper/stat_tests/YB Non-Nav Behavioral Data Spreadsheet - Abbreviated Questionnaire Answers.csv')
  
# Sort Demographic Data by Participant ID

demographic_sorted <- demographic_data[order(demographic_data$Participant),]

# Add Demographic Data to Main Data Frame

alldata$gender <- demographic_sorted$Gender

alldata$handedness <- demographic_sorted$Handedness

alldata$vr_exp_quantified <- demographic_sorted$VR.Experience.Quantified
  
alldata$vge <- demographic_sorted$Video.Game.Experience..hours.per.week.
  
alldata$exercise <- demographic_sorted$Exercise..hrs.week.

alldata$sss_diff <- alldata$sss_post - alldata$sss_pre

alldata$ssq_diff <- alldata$ssq_post - alldata$ssq_pre

```

# Create YA and OA Data Frames
```{r}

# Create YA Data Frame
ya_data <- data.frame(filter(alldata, group =="YA"))

# Create OA Data Frame
oa_data <- data.frame(filter(alldata, group =="OA"))

# Create OA NARA High Data Frame

oa_nara_high <- data.frame(filter(oa_data, nara > 50))

# Create OA NARA High Data Frame

oa_nara_low <- data.frame(filter(oa_data, nara < 50))

oa_data$nara_group <- cut(oa_data$nara,
              breaks=c(0,50,100),
              labels=c('OA Low', 'OA High'))

ya_data$nara_group <- factor(c('YA'))

# Merge OA and YA Data Frames

alldata <- rbind(oa_data, ya_data)

```

# Gender vs NARA Group
```{r}

# archive -- not using these stats (using chi square)

## Create Data Frames

# Create Data Frame for M Gender

df_male <- data.frame(filter(alldata, gender =="M"))

# Create Data Frame for F Gender

df_female <- data.frame(filter(alldata, gender == "W"))

shapiro.test(df_female$nara)

# p = 0.02739, reject H0 & cannot assume normality

shapiro.test(df_male$nara)

# p = 0.09569, fail to reject H0 & can assume normality

# Bartlett's Test for Equal Variance

bartlett.test(alldata$nara ~ alldata$gender)

# p = 0.7428, fail to reject H0 & can assume equal variance 

kruskal.test(nara~gender, data = alldata)

# p = 0.9149, fail to reject H0

## NARA AS CATEGORICAL HIGH VS LOW 

## chi-square test for gender vs nara category

gender_nara <- data.frame(alldata$gender,alldata$nara_group)
gender_nara <- table(alldata$gender,alldata$nara_group)
print(gender_nara)

# running chi square with/without Yates correction

chisq.test(table(alldata$gender, alldata$nara_group), correct = TRUE)
chisq.test(table(alldata$gender, alldata$nara_group), correct = FALSE)

chisq.test(gender_nara, correct = TRUE)

# p = 0.9013, fail to reject H0
# chi square approx may be incorrect
# we want Yates' correction (correct = TRUE) due to small sample size

```

# Exercise vs NARA Category 
```{r}

## Does exercise differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Exercise

shapiro.test(ya_data$exercise)

# p = 0.001254, reject H0 & does not follow normal distribution

shapiro.test(oa_nara_high$exercise)

# p = 0.9777, fail to reject H0

shapiro.test(oa_nara_low$exercise)

# p = 0.8735, fail to reject H0

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$exercise ~ alldata$nara_group)

# p = 0.08932, fail to reject H0 & does exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(exercise~nara_group, data = alldata)

# p = 0.3359, no difference in exercise for YA vs OA high vs OA low

```

# Trails Making A CT vs NARA Category 
```{r}

## Does Trails Making A Completion Time differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Trails A CT

shapiro.test(ya_data$trails_a_ct)

# p = 0.3793, reject H0 & does not follow normal distribution

shapiro.test(oa_nara_high$trails_a_ct)

# p = 0.2006, fail to reject H0

shapiro.test(oa_nara_low$trails_a_ct)

# p = 0.03524, reject H0 & cannot assume normality 

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$trails_a_ct ~ alldata$nara_group)

# p = 0.05834, fail to reject H0 & does exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(trails_a_ct~nara_group, data = alldata)

# p = 0.0002268, significant difference in trails making A completion time for YA vs OA high vs OA low

```

# Trails Making A Dwell Time vs NARA Category
```{r}

## Does Trails Making A Dwell Time differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Trails A DT

shapiro.test(ya_data$trails_a_dwell)

# p = 0.06561, fail to reject H0 

shapiro.test(oa_nara_high$trails_a_dwell)

# p = 0.7263, fail to reject H0

shapiro.test(oa_nara_low$trails_a_dwell)

# p = 0.03385, reject H0 & cannot assume normality 

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$trails_a_dwell ~ alldata$nara_group)

# p = 0.0159, reject H0 & does not exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(trails_a_dwell~nara_group, data = alldata)

# p = 3.084e-05, significant difference in trails making A dwell time for YA vs OA high vs OA low

```

# Trails Making B CT vs NARA Category
```{r}

## Does Trails Making B Completion Time differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Trails A CT

shapiro.test(ya_data$trails_b_ct)

# p = 0.003169, reject H0 & cannot assume normality

shapiro.test(oa_nara_high$trails_b_ct)

# p = 0.0006132, reject H0 & cannot assume normality

shapiro.test(oa_nara_low$trails_b_ct)

# p = 0.002642, reject H0 & cannot assume normality 

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$trails_b_ct ~ alldata$nara_group)

# p = 2.77e-05, reject H0 & does not exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(trails_b_ct~nara_group, data = alldata)

# p = 3.865e-05, significant difference in trails making B completion time for YA vs OA high vs OA low

```
# Trails Making B Dwell Time vs NARA Score in YA & OA 
```{r}

## Does Trails Making B Dwell Time differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Trails B DT

shapiro.test(ya_data$trails_b_dwell)

# p = 0.03843, reject H0 & cannot assume normality

shapiro.test(oa_nara_high$trails_b_dwell)

# p = 0.9806, fail to reject H0 

shapiro.test(oa_nara_low$trails_b_dwell)

# p = 0.001046, reject H0 & cannot assume normality 

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$trails_b_dwell ~ alldata$nara_group)

# p = 7.688e-08, reject H0 & does not exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(trails_b_dwell~nara_group, data = alldata)

# p = 1.777e-05, significant difference in trails making B dwell time for YA vs OA high vs OA low

```

# Set Shifting vs NARA Category
```{r}

## Does Set Shifting Time differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for Set Shifting

shapiro.test(ya_data$setshifting)

# p = 0.00212, reject H0 & cannot assume normality

shapiro.test(oa_nara_high$setshifting)

# p = 0.000308, reject H0 & cannot assume normality 

shapiro.test(oa_nara_low$setshifting)

# p = 0.001265, reject H0 & cannot assume normality 

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$setshifting ~ alldata$nara_group)

# p = 2.635e-05, reject H0 & does not exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(setshifting~nara_group, data = alldata)

# p = 0.0016, significant difference in set shifting time for YA vs OA high vs OA low

```

# SBSOD vs NARA Category
```{r}

## Does SBSOD differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for SBSOD

shapiro.test(ya_data$sbsod)

# p = 0.1743, fail to reject H0

shapiro.test(oa_nara_high$sbsod)

# p = 0.7868, fail to reject H0 

shapiro.test(oa_nara_low$sbsod)

# p = 0.5261, fail to reject H0

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$sbsod ~ alldata$nara_group)

# p = 0.5438, fail to reject H0 & does exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(sbsod~nara_group, data = alldata)

# p = 0.04696, significant difference in SBSOD for YA vs OA high vs OA low

```

# PSQI vs NARA Score in YA & OA 
```{r}

## Does PSQI differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for PSQI

shapiro.test(ya_data$psqi)

# p = 0.005512, reject H0 & cannot assume normality

shapiro.test(oa_nara_high$psqi)

# p = 0.2617, fail to reject H0 

shapiro.test(oa_nara_low$psqi)

# p = 0.3837, fail to reject H0

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$psqi ~ alldata$nara_group)

# p = 0.1538, fail to reject H0 & does exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(psqi~nara_group, data = alldata)

# p = 0.9792, no significant difference in PSQI for YA vs OA high vs OA low

```

# Video Game Experience vs NARA Score in YA & OA 
```{r}

## Does Video Game Experience (hours/week) differ in YA vs OA high/low? 

# Run Shapiro-Wilks Test for Normality in YA/OA high/OA low Dataset for VGE

shapiro.test(ya_data$vge)

# p = 3.852e-05, reject H0 & cannot assume normality

shapiro.test(oa_nara_high$vge)

# p = 1.207e-06, reject H0 & cannot assume normality

shapiro.test(oa_nara_low$vge)

# p = 1.004e-07, reject H0 & cannot assume normality

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$vge ~ alldata$nara_group)

# p = 6.201e-06, fail to reject H0 & does exhibit equal variance

# Run Kruskal-Wallis Test as Nonparametric Alternative to One Way ANOVA

kruskal.test(vge~nara_group, data = alldata)

# p = 0.01204, significant difference in video game experience (in hours/week) for YA vs OA high vs OA low


```

# VR Experience vs NARA Score in OAs
```{r}

vr_nara <- ggplot(oa_data, aes(x=vr_exp_quantified, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("VR Experience")+
  ylab("NARA Score (%)")+
  xlim(0,3) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
vr_nara

# doesn't appear significant at all based on scatterplot 



## chi-square test for vr experience vs nara category

vr_nara <- data.frame(oa_data$vr_exp_quantified,oa_data$nara_score)
vr_nara <- table(oa_data$vr_exp_quantified,oa_data$nara_score)
print(vr_nara)

# running chi square with/without Yates correction

chisq.test(table(oa_data$vr_exp_quantified, oa_data$nara_score), correct = TRUE)
chisq.test(table(oa_data$vr_exp_quantified, oa_data$nara_score), correct = FALSE)

# p = 0.5003, fail to reject H0
# chi square approx may be incorrect
# we want Yates' correction (correct = TRUE) due to small sample size

```

# Corsi Span vs NARA Score in OAs
```{r}

corsi_nara <- ggplot(oa_data, aes(x=corsi_span, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("Corsi Span")+
  ylab("NARA Score (%)")+
  xlim(2,9) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
corsi_nara

# doesn't appear significant at all based on scatterplot 

cor.test(oa_data$corsi_span, oa_data$nara, method = "spearman", exact = FALSE)

# p = 0.1554



# Does Corsi Span differ across NARA high and NARA low groups? 

# Shapiro-Wilks Test for Normality

shapiro.test(oa_nara_high$corsi_span)

# p = 0.1227, fail to reject H0

shapiro.test(oa_nara_low$corsi_span)

# p = 0.01541, reject H0 

# need nonparametric test

# Bartlett's Test for Equal Variance

bartlett.test(corsi_span~nara_score, data = oa_data)

# p = 0.3226, fail to reject H0

# As all assumptions are NOT met, we will run a Mann-Whitney U test to test for differences in VGE between the NARA High and NARA low groups. 

wilcox.test(oa_data$corsi_span ~ oa_data$nara_score, var.equal = FALSE, data = oa_data, alternative = "two.sided", exact = FALSE)

# p = 0.1501, no significant difference in exercise

```

# Corsi Mean Score vs NARA Score in OAs
```{r}

corsi_mean_nara <- ggplot(oa_data, aes(x=corsi_score_mean, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("Corsi Mean Score")+
  ylab("NARA Score (%)")+
  xlim(2,9) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
corsi_mean_nara

# doesn't appear significant at all based on scatterplot 

cor.test(oa_data$corsi_score_mean, oa_data$nara, method = "spearman", exact = FALSE)

# p = 0.1554


# Does Corsi Mean Score differ across NARA high and NARA low groups? 

# Shapiro-Wilks Test for Normality

shapiro.test(oa_nara_high$corsi_mean_score)

# p = 0.1227, fail to reject H0

shapiro.test(oa_nara_low$corsi_mean_score)

# p = 0.01541, reject H0 

# need nonparametric test

# Bartlett's Test for Equal Variance

bartlett.test(corsi_mean_score~nara_score, data = oa_data)

# p = 0.3226, fail to reject H0

# As all assumptions are NOT met, we will run a Mann-Whitney U test to test for differences in VGE between the NARA High and NARA low groups. 

wilcox.test(oa_data$corsi_mean_score ~ oa_data$nara_score, var.equal = FALSE, data = oa_data, alternative = "two.sided", exact = FALSE)

# p = 0.1501, no significant difference in exercise

```

# Corsi Total Score vs NARA Score in OAs
```{r}

corsi_total_nara <- ggplot(oa_data, aes(x=corsi_score_total, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("Corsi Total Score")+
  ylab("NARA Score (%)")+
  xlim(2,9) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
corsi_total_nara

# doesn't appear significant at all based on scatterplot 

cor.test(oa_data$corsi_score_total, oa_data$nara, method = "spearman", exact = FALSE)

# p = 0.1554

```

# Handedness vs NARA Score in OAs
```{r}

# Create Data Frames

# Create Data Frame for R Handedness

df_right <- data.frame(filter(oa_data, handedness =="R"))

# Create Data Frame for O (L/M) Handedness

# Replace L/M with O in Data Frame

oa_data[oa_data == "L"] <- "O"

oa_data[oa_data == "M"] <- "O"

# Now, Create Data Frame of O Handedness

df_other <- data.frame(filter(oa_data, handedness == "O"))

shapiro.test(df_right$nara)

# p = 0.0187, need Kruskal-Wallis

kruskal.test(nara~handedness, data = oa_data)

# p = 0.8637, fail to reject H0



## chi-square test for handedness vs nara category

handedness_nara <- data.frame(oa_data$vr_exp_quantified,oa_data$nara_score)
handedness_nara <- table(oa_data$vr_exp_quantified,oa_data$nara_score)
print(handedness_nara)

# running chi square with/without Yates correction

chisq.test(table(oa_data$handedness, oa_data$nara_score), correct = TRUE)
chisq.test(table(oa_data$handedness, oa_data$nara_score), correct = FALSE)

# p = 0.9798, fail to reject H0
# chi square approx may be incorrect
# we want Yates' correction (correct = TRUE) due to small sample size

```

# SSQ Difference vs NARA Score 
```{r}

## Does SSQ difference differ in YA vs OA? 

# Run Shapiro-Wilks Test for Normality in YA/OA Dataset for SSQ Difference

shapiro.test(ya_data$ssq_diff)

# p = 0.2226, fail to reject H0 & can assume normality

shapiro.test(oa_data$ssq_diff)

# p = 0.1747, fail to reject H0 & can assume normality

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$ssq_diff ~ alldata$group)

# p = 0.1083, fail to reject H0 & can assume equal variance

# Run Two Sample T Test

t.test(alldata$ssq_diff ~ group, data = alldata)

# p = 0.9715, no difference in SSQ difference for YA vs OA

# Run Correlation Test for SSQ Difference & NARA in OAs

# Test Each Dataset for Normality

shapiro.test(oa_data$ssq_diff)

# p = 0.7381, fail to reject H0 & can assume normality

shapiro.test(oa_data$nara)

# p = 0.005657, reject H0 & cannot assume normality

# need to run Spearman correlation as nonparametric alternative

# Generate Scatterplot

ssqdiff_nara <- ggplot(oa_data, aes(x=ssq_diff, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("SSQ Difference (post - pre)")+
  ylab("NARA Score (%)")+
  xlim(-7,15) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
ssqdiff_nara

# most of scatterplot outside confidence interval, poor representation

cor.test(oa_data$ssq_diff, oa_data$nara, method = "spearman", exact = FALSE)

# rho = 0.05284319, p = 0.8153
# no significant association between SSQ difference & NARA score in OAs



# Does SSQ difference differ across NARA high and NARA low groups? 

# Shapiro-Wilks Test for Normality

shapiro.test(oa_nara_high$ssq_diff)

# p = 0.3936, fail to reject H0

shapiro.test(oa_nara_low$ssq_diff)

# p = 0.06968, fail to reject H0 

# Bartlett's Test for Equal Variance

bartlett.test(ssq_diff~nara_score, data = oa_data)

# p = 0.9645, fail to reject H0

# As all assumptions are met, we will run a 2 sample t test to test for differences in VGE between the NARA High and NARA low groups. 

t.test(oa_data$ssq_diff ~ oa_data$nara_score, var.equal = TRUE, data = oa_data, alternative = "two.sided")

# p = 0.9638, no significant difference in ssq difference

```

# SSS Difference vs NARA Score
```{r}

## Does SSS difference differ in YA vs OA? 

# Run Shapiro-Wilks Test for Normality in YA/OA Dataset for SSS Difference

shapiro.test(ya_data$sss_diff)

# p = 0.0007346, reject H0 & cannot assume normality

shapiro.test(oa_data$sss_diff)

# p = 0.0003588, reject H0 & cannot assume normality

# Run Bartlett's Test for Equal Variance

bartlett.test(alldata$sss_diff ~ alldata$group)

# p = 0.003573, reject H0 & cannot assume equal variance

# Run Mann Whitney U Test as nonparametric alternative to two sample t test

wilcox.test(alldata$sss_diff ~ group, data = alldata, exact = FALSE)

# p = 0.4963, no difference in SSS difference for YA vs OA

# Run Correlation Test for SSS Difference & NARA in OAs

# Test Each Dataset for Normality

shapiro.test(oa_data$sss_diff)

# p = 0.0003588, reject H0 & cannot assume normality

shapiro.test(oa_data$nara)

# p = 0.005657, reject H0 & cannot assume normality

# need to run Spearman correlation as nonparametric alternative

# Generate Scatterplot

sssdiff_nara <- ggplot(oa_data, aes(x=sss_diff, y=nara), cor_method = "spearman") + 
  geom_point(color = "#FF6EC7")+
  geom_smooth(method=lm, color = "black", fill = "#FF6EC7") +
  xlab("SSS Difference (post - pre)")+
  ylab("NARA Score (%)")+
  xlim(-3,3) +
  ylim(0, 100) +
  theme(text = element_text(size = 20),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
sssdiff_nara

# most of scatterplot outside confidence interval, poor representation

cor.test(oa_data$sss_diff, oa_data$nara, method = "spearman", exact = FALSE)

# rho = -0.03754135, p = 0.8683
# no significant association between SSS difference & NARA score in OAs



# Does SSS difference differ across NARA high and NARA low groups? 

# Shapiro-Wilks Test for Normality

shapiro.test(oa_nara_high$sss_diff)

# p = 9.811e-06, reject H0

shapiro.test(oa_nara_low$sss_diff)

# p = 0.07391, fail to reject H0 

# need nonparametric test

# Bartlett's Test for Equal Variance

bartlett.test(sss_diff~nara_score, data = oa_data)

# p = 0.003373, reject H0

# As all assumptions are NOT met, we will run a Mann Whitney U Test to test for differences in SSS difference between the NARA High and NARA low groups. 

wilcox.test(oa_data$sss_diff ~ oa_data$nara_score, var.equal = FALSE, data = oa_data, alternative = "two.sided", exact = FALSE)

# p = 0.9701, no significant difference in ssq difference

```




